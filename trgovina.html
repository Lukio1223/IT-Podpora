<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spletna trgovina - Matkomp</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f2f5f9;
      margin: 0; padding: 2em;
      color: #2e3a59;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    h1 {
      text-align: center;
      margin-bottom: 1em;
    }
    .izdelek {
      background: white;
      padding: 1.5em;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 2em;
      display: flex;
      align-items: flex-start;
      gap: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin-right: 10px;
      transition: background-color 0.3s;
    }
    button:hover:not(:disabled) {
      background-color: #0056b3;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      color: #666;
    }
    /* Iskalnik */
    #search {
      width: 100%;
      padding: 12px;
      font-size: 1.1rem;
      margin-bottom: 1.5em;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
    }
    .opis {
      flex: 1;
    }
    img {
      width: 250px;
      border-radius: 12px;
    }
  </style>
</head>
<body>
  <div style="text-align: right;">
    <button onclick="location.href='kosarica.html'">🛒 Košarica</button>
  </div>
  <h1>Spletna trgovina Matkomp</h1>

  <!-- Iskalnik -->
  <input type="search" id="search" placeholder="Išči izdelek..." />

  <div id="izdelki-lista"></div>

  <script>
    // Če imamo zalogo v localStorage, jo uporabimo, drugače nastavimo začetno
    let izdelki = JSON.parse(localStorage.getItem('zaloga')) || [
      {
        ime: "Lenovo IS6XM",
        cena: 29.99,
        opis: `Lenovo IS6XM (rev 1.0) je mikro ATX matična plošča s podnožjem LGA 1155, namenjena pisarniškim računalnikom Lenovo ThinkCentre, kot so M81, M91 in M91p. Podnožje: LGA 1155 (za Intel 2. in 3. generacijo Core i7/i5/i3, Pentium)
Čipovje: Intel Q67 ali Q61
RAM: 4 reže za DDR3 (do 32 GB)
Razširitvene reže: 1 × PCIe x16, 1 × PCIe x1, včasih še 1 × PCI
Video izhodi: VGA in DisplayPort
SATA: 4 priključki
USB: Več USB 2.0 vhodov (brez USB 3.0)
BIOS: Lenovo OEM; včasih potreben posodobitev za novejše grafične kartice`,
        slika: "is6mx.jpg",
        zaloga: 1
      },
      // Lahko dodaš še več izdelkov tukaj s to strukturo:
      /*
      {
        ime: "Drugi izdelek",
        cena: 19.99,
        opis: "Opis izdelka ...",
        slika: "drugi.jpg",
        zaloga: 5
      }
      */
    ];

    // Shranimo zalogo v localStorage
    localStorage.setItem('zaloga', JSON.stringify(izdelki));

    const container = document.getElementById('izdelki-lista');

    function prikaziIzdelke() {
      container.innerHTML = '';
      izdelki.forEach((izdelek, index) => {
        const div = document.createElement('div');
        div.className = 'izdelek';

        div.innerHTML = `
          <img src="${izdelek.slika}" alt="${izdelek.ime}" />
          <div class="opis">
            <h2>${izdelek.ime}</h2>
            <p>${izdelek.opis}</p>
            <p><strong>Cena:</strong> ${izdelek.cena.toFixed(2)} €</p>
            <p><strong>Zaloga:</strong> ${izdelek.zaloga}</p>
          </div>
        `;

        // Dodaj gumb ali napis "Ni na zalogi"
        const btnAdd = document.createElement('button');
        btnAdd.textContent = "Dodaj v košarico";
        btnAdd.disabled = izdelki[index].zaloga <= 0;
        btnAdd.onclick = () => {
          dodajVKosarico(index);
        };

        if (izdelek.zaloga <= 0) {
          btnAdd.textContent = "Ni na zalogi";
        }
        div.querySelector('.opis').appendChild(btnAdd);

        // Gumb Kupi zdaj
        const btnBuy = document.createElement('button');
        btnBuy.textContent = "Kupi zdaj";
        btnBuy.onclick = () => {
          location.href = 'kosarica.html';
        };
        div.querySelector('.opis').appendChild(btnBuy);

        container.appendChild(div);
      });
    }

    function dodajVKosarico(index) {
      if (izdelki[index].zaloga <= 0) {
        alert('Izdelek ni več na zalogi.');
        return;
      }

      // Dodaj v košarico (localStorage)
      const kosarica = JSON.parse(localStorage.getItem('kosarica')) || [];
      kosarica.push({
        ime: izdelki[index].ime,
        cena: izdelki[index].cena
      });
      localStorage.setItem('kosarica', JSON.stringify(kosarica));

      // Zmanjšaj zalogo in shrani
      izdelki[index].zaloga -= 1;
      localStorage.setItem('zaloga', JSON.stringify(izdelki));

      // Ponovno prikaži izdelke, da se posodobi stanje
      prikaziIzdelke();

      alert('Izdelek dodan v košarico!');
    }

    // Iskalnik
    const input = document.getElementById('search');
    input.addEventListener('input', () => {
      const filter = input.value.toLowerCase();
      const izdelkiDivs = container.querySelectorAll('.izdelek');

      izdelkiDivs.forEach(div => {
        const naslov = div.querySelector('h2').textContent.toLowerCase();
        const opis = div.querySelector('.opis p').textContent.toLowerCase();
        if (naslov.includes(filter) || opis.includes(filter)) {
          div.style.display = 'flex';
        } else {
          div.style.display = 'none';
        }
      });
    });

    // Inicialni prikaz
    prikaziIzdelke();
  </script>
</body>
</html>
