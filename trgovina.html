<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spletna trgovina - Matkomp</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f2f5f9;
      margin: 0; padding: 2em;
      color: #2e3a59;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    h1 {
      text-align: center;
      margin-bottom: 1em;
    }
    .izdelek {
      background: white;
      padding: 1.5em;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 2em;
      display: flex;
      align-items: flex-start;
      gap: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin-right: 10px;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #0056b3;
    }
    #search {
      width: 100%;
      padding: 12px;
      font-size: 1.1rem;
      margin-bottom: 1.5em;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
    }
    .opis {
      flex: 1;
    }
    a.izdelek-link {
      color: #007bff;
      text-decoration: underline;
      cursor: pointer;
      font-size: 1.4em;
      font-weight: bold;
    }
    a.izdelek-link:hover {
      color: #0056b3;
    }
    .zaloga {
      margin-top: 0.5em;
      font-weight: 600;
      color: #b30000;
    }
  </style>
</head>
<body>
  <div style="text-align: right;">
    <button onclick="location.href='kosarica.html'">üõí Ko≈°arica</button>
  </div>
  <h1>Spletna trgovina Matkomp</h1>

  <input type="search" id="search" placeholder="I≈°ƒçi izdelek..." />

<div id="container"></div>

<script>
  const izdelki = [
    {
      id: 0,
      ime: "Lenovo IS6XM",
      cena: 29.99,
      opis: `Lenovo IS6XM (rev 1.0) je mikro ATX matiƒçna plo≈°ƒça s podno≈æjem LGA 1155, namenjena pisarni≈°kim raƒçunalnikom Lenovo ThinkCentre, kot so M81, M91 in M91p. Podno≈æje: LGA 1155 (za Intel 2. in 3. generacijo Core i7/i5/i3, Pentium)
ƒåipovje: Intel Q67 ali Q61
RAM: 4 re≈æe za DDR3 (do 32 GB)
Raz≈°iritvene re≈æe: 1 √ó PCIe x16, 1 √ó PCIe x1, vƒçasih ≈°e 1 √ó PCI
Video izhodi: VGA in DisplayPort
SATA: 4 prikljuƒçki
USB: Veƒç USB 2.0 vhodov (brez USB 3.0)
BIOS: Lenovo OEM; vƒçasih potreben posodobitev za novej≈°e grafiƒçne kartice`,
      slika: "is6mx.jpg",
      zaloga: 1
    }
  ];

  const urlParams = new URLSearchParams(window.location.search);
  const id = parseInt(urlParams.get('id'));
  const container = document.getElementById('container');

  const izdelek = izdelki.find(i => i.id === id);

  if (isNaN(id) || !izdelek) {
    container.innerHTML = '<p>Izdelek ni najden.</p>';
  } else {
    container.innerHTML = `
      <h1>${izdelek.ime}</h1>
      <img src="${izdelek.slika}" alt="${izdelek.ime}" style="width: 300px; border-radius: 12px;" />
      <p>${izdelek.opis.replace(/\n/g, '<br>')}</p>
      <p><strong>Cena:</strong> ${izdelek.cena.toFixed(2)} ‚Ç¨</p>
      <p><strong>Zaloga:</strong> ${izdelek.zaloga > 0 ? izdelek.zaloga : '<span style="color:red;">Ni na zalogi</span>'}</p>
      <button onclick="dodajVKosarico('${izdelek.ime}', ${izdelek.cena})" ${izdelek.zaloga <= 0 ? 'disabled' : ''}>Dodaj v ko≈°arico</button>
      <button onclick="location.href='kosarica.html'">Kupi zdaj</button>
    `;
  }

  function dodajVKosarico(ime, cena) {
    const kosarica = JSON.parse(localStorage.getItem('kosarica')) || [];
    kosarica.push({ ime, cena });
    localStorage.setItem('kosarica', JSON.stringify(kosarica));
    alert('Izdelek dodan v ko≈°arico!');
  }
</script>

    `;

    container.appendChild(div);
  });
</script>


    // Nalaganje zaloge iz localStorage ali nastavi zaƒçetno, ƒçe ni
    function naloziZalogo() {
      const zalogaLS = localStorage.getItem('zaloga');
      if (zalogaLS) {
        const zaloga = JSON.parse(zalogaLS);
        for (const izdelek of izdelki) {
          const z = zaloga.find(z => z.id === izdelek.id);
          if (z) izdelek.zaloga = z.zaloga;
        }
      } else {
        localStorage.setItem('zaloga', JSON.stringify(izdelki.map(i => ({ id: i.id, zaloga: i.zaloga }))));
      }
    }

    // Shrani zalogo v localStorage
    function shraniZalogo() {
      localStorage.setItem('zaloga', JSON.stringify(izdelki.map(i => ({ id: i.id, zaloga: i.zaloga }))));
    }

    // Prikaz izdelkov
    function prikaziIzdelke(filter = '') {
      const list = document.getElementById('izdelki-list');
      list.innerHTML = '';
      const niz = filter.toLowerCase();

      izdelki.forEach(izdelek => {
        if (!izdelek.ime.toLowerCase().includes(niz) && !izdelek.opis.toLowerCase().includes(niz)) return;

        const div = document.createElement('div');
        div.className = 'izdelek';

        const img = document.createElement('img');
        img.src = izdelek.slika;
        img.alt = izdelek.ime;
        img.style.width = '250px';
        img.style.borderRadius = '12px';

        const opisDiv = document.createElement('div');
        opisDiv.className = 'opis';

        const naslov = document.createElement('h2');
        const link = document.createElement('a');
        link.href = `izdelek.html?id=${izdelek.id}`;
        link.textContent = izdelek.ime;
        link.className = 'izdelek-link';
        naslov.appendChild(link);

        const opisP = document.createElement('p');
        opisP.textContent = izdelek.opis;

        const cenaP = document.createElement('p');
        cenaP.innerHTML = `<strong>Cena:</strong> ${izdelek.cena.toFixed(2)} ‚Ç¨`;

        const zalogaP = document.createElement('p');
        zalogaP.className = 'zaloga';
        if (izdelek.zaloga > 0) {
          zalogaP.textContent = `Na zalogi: ${izdelek.zaloga}`;
          zalogaP.style.color = 'green';
        } else {
          zalogaP.textContent = 'Ni na zalogi';
          zalogaP.style.color = 'red';
        }

        const dodajBtn = document.createElement('button');
        dodajBtn.textContent = 'Dodaj v ko≈°arico';
        dodajBtn.disabled = izdelek.zaloga <= 0;
        dodajBtn.onclick = () => {
          if (izdelek.zaloga <= 0) {
            alert('Izdelek ni na zalogi.');
            return;
          }

          const kosarica = JSON.parse(localStorage.getItem('kosarica')) || [];
          kosarica.push({ id: izdelek.id, ime: izdelek.ime, cena: izdelek.cena });
          localStorage.setItem('kosarica', JSON.stringify(kosarica));

          izdelek.zaloga--;
          shraniZalogo();
          prikaziIzdelke(document.getElementById('search').value);

          alert('Izdelek dodan v ko≈°arico!');
        };

        const kupiBtn = document.createElement('button');
        kupiBtn.textContent = 'Kupi zdaj';
        kupiBtn.onclick = () => {
          location.href = 'kosarica.html';
        };

        opisDiv.appendChild(naslov);
        opisDiv.appendChild(opisP);
        opisDiv.appendChild(cenaP);
        opisDiv.appendChild(zalogaP);
        opisDiv.appendChild(dodajBtn);
        opisDiv.appendChild(kupiBtn);

        div.appendChild(img);
        div.appendChild(opisDiv);

        list.appendChild(div);
      });
    }

    naloziZalogo();
    prikaziIzdelke();

    document.getElementById('search').addEventListener('input', (e) => {
      prikaziIzdelke(e.target.value);
    });
  </script>
</body>
</html>
